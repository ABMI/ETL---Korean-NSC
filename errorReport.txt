DBMS:
sql server

Error:
com.microsoft.sqlserver.jdbc.SQLServerException: Connection reset by peer: socket write error

SQL:
INSERT INTO NHIS_NSC_2019.dbo.PAYER_PLAN_PERIOD (payer_plan_period_id, person_id, payer_plan_period_start_date, payer_plan_period_end_date, payer_source_value, plan_source_value, family_source_value)
	SELECT	a.person_id+STND_Y as payer_plan_period_id,
			a.person_id as person_id,
			cast(convert(VARCHAR, STND_Y + '0101' ,23) as date) as payer_plan_period_start_date,
			case when year < death_date then a.year
			when year > death_date then death_date
			else a.year
			end as payer_plan_period_end_date,
			payer_source_value = 'National Health Insurance Service',
			IPSN_TYPE_CD as plan_source_value,
			family_source_value = null
	FROM 
			(select person_id, STND_Y, IPSN_TYPE_CD, cast(convert(VARCHAR, cast(STND_Y as varchar) + '1231' ,23) as date) as year from NHISNSC2013Original.dbo.NHID_JK) a left join NHIS_NSC_2019.dbo.DEATH b
	  		on a.person_id=b.person_id

R version:
R version 3.5.1 (2018-07-02)

Platform:
x86_64-w64-mingw32

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- etlKoreanNSC (0.0.0.9000)
- DatabaseConnector (2.2.1)